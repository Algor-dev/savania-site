<!DOCTYPE html>
<html>
<head>
    <title>Debug Formulaire</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
</head>
<body>
    <h1>DEBUG FORMULAIRE</h1>
    
    <form id="debugForm">
        <input type="text" name="name" placeholder="Nom" required value="Test Debug"><br>
        <input type="email" name="email" placeholder="Email" required value="debug@test.com"><br>
        <input type="tel" name="phone" placeholder="T√©l√©phone" required value="70 11 22 33"><br>
        <select name="service" required>
            <option value="piscine">Piscine</option>
        </select><br>
        <input type="text" name="subject" placeholder="Sujet" required value="Test Debug"><br>
        <textarea name="message" placeholder="Message" required>Message de test debug</textarea><br>
        <button type="submit">TESTER L'ENVOI</button>
    </form>
    
    <div id="debugResult"></div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyBIEKk9ijRz0ilg0dfhH_ZnebM-K03qy5U",
            authDomain: "savania-a8fdd.firebaseapp.com",
            projectId: "savania-a8fdd",
            storageBucket: "savania-a8fdd.firebasestorage.app",
            messagingSenderId: "891693775472",
            appId: "1:891693775472:web:23711b1c7be5c6b17592b5",
            measurementId: "G-SYDQ0JFSN4"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        document.getElementById('debugForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const formData = {
                name: e.target.name.value,
                email: e.target.email.value,
                phone: e.target.phone.value,
                service: e.target.service.value,
                subject: e.target.subject.value,
                message: e.target.message.value,
                newsletter: false,
                status: 'nouveau',
                read: false,
                timestamp: firebase.firestore.FieldValue.serverTimestamp()
            };

            console.log("üì§ Donn√©es √† envoyer:", formData);

            try {
                const result = await db.collection('contacts').add(formData);
                console.log("‚úÖ Succ√®s - Document ID:", result.id);
                
                document.getElementById('debugResult').innerHTML = 
                    '<h3 style="color: green">‚úÖ FORMULAIRE FONCTIONNE!</h3>' +
                    '<p>Document ID: ' + result.id + '</p>' +
                    '<p>Allez v√©rifier dans Firebase Console et Admin</p>';
                
            } catch (error) {
                console.error("‚ùå Erreur:", error);
                document.getElementById('debugResult').innerHTML = 
                    '<h3 style="color: red">‚ùå ERREUR FORMULAIRE</h3>' +
                    '<p><strong>Code:</strong> ' + error.code + '</p>' +
                    '<p><strong>Message:</strong> ' + error.message + '</p>';
            }
        });
    </script>
</body>
</html>